# CPP åŸºç¡€



### ä¼˜åŒ–æŠ€å·§

1.   ä¹˜æ³•æ¯”é™¤æ³•æ›´å¿«ï¼Œé€‚å½“çš„ä¼˜åŒ–è¡¨è¾¾å¼ä»¥å‡å°‘é™¤æ³•çš„ä½¿ç”¨ã€‚

2.   ä½¿ç”¨æ•°å­¦å‡½æ•°æ—¶éœ€è¦åŠ ä¸Š`std::`ï¼Œè¿™æ‰æ˜¯CPPçš„æ•°å­¦å‡½æ•°ï¼Œå…¨å±€çš„æ•°å­¦å‡½æ•°æ˜¯Cè¯­è¨€çš„ã€‚

3.   å‚æ•°å®šä¹‰ä¸ºå¸¸å¼•ç”¨`void func(cconst& a){}`

4.   ç¼–è¯‘å™¨ä¼˜åŒ–æ€»ç»“

     >   1.   å‡½æ•°å°½é‡å†™åœ¨åŒä¸€ä¸ªæ–‡ä»¶å†…
     >   2.   é¿å…åœ¨ for å¾ªç¯å†…è°ƒç”¨å¤–éƒ¨å‡½æ•°
     >   3.   é const æŒ‡é’ˆåŠ ä¸Š __restrict ä¿®é¥°
     >   4.   è¯•ç€ç”¨ SOA å–ä»£ AOS
     >   5.   å¯¹é½åˆ° 16 æˆ– 64 å­—èŠ‚
     >   6.   ç®€å•çš„ä»£ç ï¼Œä¸è¦å¤æ‚åŒ–
     >   7.   è¯•è¯•çœ‹ #pragma omp simd
     >   8.   å¾ªç¯ä¸­ä¸å˜çš„å¸¸é‡æŒªåˆ°å¤–é¢æ¥
     >   9.   å¯¹å°å¾ªç¯ä½“ç”¨ #pragma unroll
     >   10.   -ffast-math å’Œ -march=native

5.   å¯¹å‡½æ•°æ¥è¯´ï¼Œç°åœ¨`inline`æ¯”è¾ƒå¤šä½™äº†ï¼Œç¼–è¯‘å™¨ä¼šæ™ºèƒ½å†³å®šæ˜¯å¦å†…è”

6.   const int* å’Œ int const* çš„è¾©è¯ï¼šhttps://www.zhihu.com/question/443195492

7.   æ¨èå°†`const`å†™åœ¨ç±»å‹å³ä¾§ï¼Œæ¯”å¦‚`int const`ï¼Œ`std::string const`ï¼Œ`std::vector<int> const&`

8.   é¿å…ä½¿ç”¨`long`æ•°æ®ç±»å‹ï¼Œå› ä¸ºåœ¨ä¸åŒçš„å¹³å°`long`çš„ä½æ•°ä¸ç›¸åŒã€‚
     Cè¯­è¨€`stdint.h`å®šä¹‰äº†(C++ä¸­æ˜¯`cstdint`)ï¼š

     ```cpp
     typedef char int8_t;
     typedef short int16_t;
     typedef int int32_t;
     typedef long long int64_t;
     
     typedef unsigned char uint8_t;
     typedef unsigned short uint16_t;
     typedef unsigned int uint32_t;
     typedef unsigned long long uint64_t;
     ```

9.   `size_t`è¡¨ç¤ºå¤§å°çš„æ•´æ•°å‹ï¼Œå…¶ç­‰ä»·äº`uintptr_t`

10.   åœ¨Modern C++ä¸­ä½¿ç”¨`nullptr`æ¥è¡¨ç¤ºç©ºæŒ‡é’ˆè€Œä¸æ˜¯`NULL`æˆ–è€…`0`
11.   `for (int i = 0; i < n; i ++)`æœ€å¥½å†™ä¸º`for (size_t i = 0; i < n; i ++)`ï¼Œè®°å¾—`#include <cstdint>`
12.   ä½¿ç”¨`new T[n]`åˆ†é…çš„åŠ¨æ€æ•°ç»„ï¼Œè¯·ä½¿ç”¨`delete[]`é‡Šæ”¾
13.   ä½¿ç”¨`new T`åˆ†é…çš„å•ä¸ªå…ƒç´ ï¼Œè¯·ä½¿ç”¨`delete`é‡Šæ”¾
14.   ä½¿ç”¨`std::swap`æ¥äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼(`#include <utility>`)
15.   `i++`å’Œ`++i`æ•ˆæœå·®ä¸å¤šï¼Œä½†æ˜¯æ¨èä½¿ç”¨`++i`ï¼Œåœ¨ä½¿ç”¨è¿­ä»£å™¨æ—¶å¯ä»¥å‡å°‘ä¸€äº›æ€§èƒ½å¼€é”€ã€‚
16.   C++ä¸­è·å–Cæ•°ç»„çš„é•¿åº¦å¯ä»¥ç”¨`std::size(b)`ï¼Œè€Œä¸æ˜¯`sizeof(b)/sizeof(b[0])`
17.   `# pragma once` æ˜¯ä¸€ä¸ª**éæ ‡å‡†**çš„ä½†å¹¿æ³›æ”¯æŒçš„é¢„å¤„ç†æŒ‡ä»¤ï¼Œå®ƒå‘Šè¯‰ç¼–è¯‘å™¨è¯¥å¤´æ–‡ä»¶åœ¨å•ä¸ªç¼–è¯‘è¿‡ç¨‹ä¸­åªåº”è¢«åŒ…å«ä¸€æ¬¡ã€‚ç¼–è¯‘å™¨åœ¨ç¬¬ä¸€æ¬¡é‡åˆ° `#pragma once` æ—¶ä¼šè®°ä½è¯¥æ–‡ä»¶åï¼Œå¹¶åœ¨åç»­çš„åŒ…å«æ“ä½œä¸­å¿½ç•¥å®ƒã€‚
18.   ä½¿ç”¨é¢„å¤„ç†æŒ‡ä»¤é˜²æ­¢å¤´æ–‡ä»¶è¢«é‡å¤åŒ…å«ï¼ˆä¹Ÿç§°ä¸ºâ€œå¤´æ–‡ä»¶ä¿æŠ¤â€æˆ–â€œåŒ…å«å«å£«â€ï¼‰ï¼š`#ifndef`, `#define`, `#endif`
      ```cpp title="example.h"
      #ifndef EXAMPLE_H
      #define EXAMPLE_H
      
      class MyClass {
      public:
          MyClass(); // æ„é€ å‡½æ•°å£°æ˜
          void myFunction(); // æˆå‘˜å‡½æ•°å£°æ˜
      };
      
      #endif
      ```

19.   



å †æ ˆçš„åˆ†é…

æ ˆï¼šarray

å †ï¼švectorã€string



### åŒ¿åå‡½æ•°(Lambda Function)

```cpp
#include <iostream>

int main()
{
    auto func = [] (int a) -> int {
        return a * 2;
    };
    std::cout << func(2) << std::endl;
    return 0;
}
```

åªæœ‰ä¸€ä¸ª`return`æ—¶ï¼Œå¯ä»¥ lambda è¡¨è¾¾å¼å¯ä»¥ä¸é€šè¿‡`->`æŒ‡å®šç±»å‹ï¼Œå’Œ`-> auto`ç­‰ä»·ï¼Œè‡ªåŠ¨æ ¹æ®å‡½æ•°ä½“å†…çš„ `return` è¯­å¥å†³å®šè¿”å›ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰ `return` è¯­å¥ï¼Œåˆ™ç›¸å½“äº`-> void`ã€‚

lambdaå‡½æ•°ä½“é‡ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å®šä¹‰ä»–çš„å‡½æ•°ä¸­çš„å˜é‡ï¼Œåªéœ€è¦æŠŠ`[]`æ”¹ä¸º`[&]`å³å¯ã€‚

```cpp
#include <iostream>

int main()
{
    int a, b;
    std::cin >> a >> b;
    auto func = [&] () {
        return a + b;
    };
    std::cout << func() << std::endl;
    return 0;
}
```

å‡½æ•°å¯ä»¥å¼•ç”¨å®šä¹‰ä½ç½®æ‰€æœ‰çš„å˜é‡ï¼Œè¿™ä¸ªç‰¹æ€§åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­è¢«ç§°ä¸ºé—­åŒ…(closure)ã€‚

åœ¨ä½¿ç”¨`[&]`æ—¶éœ€è¦ä¿è¯lambdaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸è¶…è¿‡ä»–æ‰€æ•è·çš„æ‰€æœ‰å¼•ç”¨çš„å¯¿å‘½ã€‚

å¯ä»¥ä½¿ç”¨`[=]`æ¥æ•è·å€¼è€Œä¸æ˜¯å¼•ç”¨ï¼Œ`[=]`ä¼šç»™æ¯ä¸€ä¸ªå¼•ç”¨äº†çš„å˜é‡åšä¸€ä»½æ‹·è´ã€‚

lambda ä½œä¸ºå‚æ•°ï¼šé€šå¸¸ç”¨ `[&]` å­˜å‚¨å¼•ç”¨ã€‚

lambda ä½œä¸ºè¿”å›å€¼ï¼šæ€»æ˜¯ç”¨ `[=]` å­˜å‚¨å€¼ã€‚



#### åŸºæœ¬è¯­æ³•

```cpp
[capture](parameters) -> return_type { 
    // å‡½æ•°ä½“ 
}
```

#### åŸºæœ¬ç¤ºä¾‹

```cpp
// æ— å‚Lambda
auto greet = []() {
    std::cout << "Hello, Lambda!";
};
greet(); // è¾“å‡º: Hello, Lambda!

// å¸¦å‚Lambda
auto add = [](int a, int b) {
    return a + b;
};
std::cout << add(3, 4); // è¾“å‡º: 7
```

#### æ•è·å¤–éƒ¨å˜é‡

æ§åˆ¶Lambdaå¦‚ä½•è®¿é—®å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡ï¼š

```cpp
int x = 10, y = 20;

// æŒ‰å€¼æ•è·ï¼ˆå¤åˆ¶å˜é‡ï¼‰
auto copy = [x]() { 
    std::cout << x; // x=10ï¼ˆå¤–éƒ¨ä¿®æ”¹ä¸å½±å“å†…éƒ¨ï¼‰
};
x = 100; // ä¿®æ”¹å¤–éƒ¨x
copy();  // ä»è¾“å‡º10

// æŒ‰å¼•ç”¨æ•è·ï¼ˆç›´æ¥æ“ä½œå¤–éƒ¨å˜é‡ï¼‰
auto ref = [&y]() { 
    y++; // ä¿®æ”¹å¤–éƒ¨y
};
ref();
std::cout << y; // è¾“å‡º21
```

æ•è·æ–¹å¼æ€»ç»“ï¼š

| æ•è·å½¢å¼  | æ•ˆæœ                       |
| --------- | -------------------------- |
| `[ ]`     | ä¸æ•è·ä»»ä½•å˜é‡             |
| `[=]`     | æŒ‰å€¼æ•è·æ‰€æœ‰å¤–éƒ¨å˜é‡       |
| `[&]`     | æŒ‰å¼•ç”¨æ•è·æ‰€æœ‰å¤–éƒ¨å˜é‡     |
| `[x, &y]` | æ··åˆæ•è·ï¼ˆxæŒ‰å€¼ï¼ŒyæŒ‰å¼•ç”¨ï¼‰ |
| `[=, &y]` | é»˜è®¤æŒ‰å€¼ï¼Œä½†yæŒ‰å¼•ç”¨        |
| `[&, x]`  | é»˜è®¤æŒ‰å¼•ç”¨ï¼Œä½†xæŒ‰å€¼        |
| `[this]`  | æ•è·å½“å‰å¯¹è±¡æŒ‡é’ˆ           |

> :warning:é¿å…é»˜è®¤æ•è·ï¼ˆ`[=]`/`[&]`ï¼‰ï¼Œæ˜¾å¼åˆ—å‡ºå˜é‡æ›´å®‰å…¨ï¼
> æœ€å°æ•è·åŸåˆ™ã€‚



### ç±»å‹è½¬æ¢

`static_cast<T*>`

## STL

è¯¦è§ï¼š[STL](./STL.md)

### Containerï¼ˆå®¹å™¨ï¼‰

#### `std::vector`

vectorçš„`size`å’Œ`capacity`æ˜¯åˆ†ç¦»çš„ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡`push_back`éƒ½ä¼šæ”¹å˜`capacity`ã€‚ï¼ˆå‚è€ƒï¼š[std::vectorâ€‚Size vs. Capacity](https://hackingcpp.com/cpp/lang/memory_basics.html)ï¼‰

å½“`capacity`æ”¹å˜æ—¶ï¼Œå°±æ˜¯é‡æ–°åˆ†é…äº†ä¸€æ¬¡å†…å­˜ï¼Œä¼šå°†åŸæ¥ä½ç½®çš„æ•°æ®copyåˆ°æ–°çš„ä½ç½®ã€‚

`clear()`åªæ˜¯å°†`size`å˜ä¸º0

`shrink_to_fit()`å°†`capacity`ç¼©å›åˆ°`size`å¤§å°ã€‚

ä¸€å¯¹è¿­ä»£å™¨`begin()`å’Œ`end()`å°±æ ‡è®°äº†ä¸€ä¸ªåŒºé—´(range)ï¼ŒåŒºé—´å¯ä»¥æ˜¯ä¸€ä¸ªå®¹å™¨çš„å…¨éƒ¨ï¼Œä¾‹å¦‚`{a.being(), a.end()}`ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŠ å‡å¾—åˆ°ä¸€ä¸ªå»å¤´å»å°¾çš„å­åˆ—è¡¨ï¼Œä¾‹å¦‚`{a.begin() +1, a.end() + 1}`ï¼Œç›¸å½“äºpythonçš„`a[1:-1]`ã€‚



#### `std::list`



#### `std::string`

```cpp
auto s1 = "seven of"s;  // type of s1 is std::string
```

| `R"(...)"`                            |                |       |
| ------------------------------------- | -------------- | ----- |
| `R"(raw "C"-string c:\users\joe)"`    | `char const[]` | C++11 |
| `R"(raw "std"-string c:\users\moe)"s` | `std::string`  | C++14 |

`std::getline`



`<cctype>`ä¸­çš„å¸®æ‰‹å‡½æ•°

>   isupper(c) åˆ¤æ–­æ˜¯å¦ä¸ºå¤§å†™å­—æ¯ï¼ˆâ€˜Aâ€™ <= c && c <= â€˜Zâ€™ï¼‰
>
>   islower(c) åˆ¤æ–­æ˜¯å¦ä¸ºå°å†™å­—æ¯ï¼ˆâ€˜aâ€™ <= c && c <= â€˜zâ€™ï¼‰
>
>   isalpha(c) åˆ¤æ–­æ˜¯å¦ä¸ºå­—æ¯ï¼ˆåŒ…æ‹¬å¤§å†™å’Œå°å†™ï¼‰
>
>   isdigit(c) åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ï¼ˆâ€˜0â€™ <= c && c <= â€˜9â€™ï¼‰
>
>   isalnum(c) åˆ¤æ–­æ˜¯å¦ä¸ºå­—æ¯æˆ–æ•°å­—ï¼ˆåŒ…æ‹¬å­—æ¯å’Œæ•°å­—ï¼‰
>
>   isxdigit(c) åˆ¤æ–­æ˜¯å¦ä¸ºåå…­è¿›åˆ¶æ•°å­—ï¼ˆ0~9 æˆ– a-f æˆ– A-Fï¼‰
>
>   isspace(c) åˆ¤æ–­æ˜¯å¦ä¸ºç­‰ä»·äºç©ºæ ¼çš„å­—ç¬¦ï¼ˆâ€˜ â€™ æˆ– â€˜\tâ€™ æˆ– â€˜\nâ€™ æˆ– â€˜\vâ€™ æˆ– â€˜\râ€™ï¼‰
>
>   iscntrl(c) åˆ¤æ–­æ˜¯å¦ä¸ºæ§åˆ¶å­—ç¬¦ï¼ˆ0 <= c && c <= 31 æˆ– c == 127ï¼‰
>
>   toupper(c) æŠŠå°å†™å­—æ¯è½¬æ¢ä¸ºå¤§å†™å­—æ¯ï¼Œå¦‚æœä¸æ˜¯åˆ™åŸå°ä¸åŠ¨è¿”å›
>
>   tolower(c) æŠŠå¤§å†™å­—æ¯è½¬æ¢ä¸ºå°å†™å­—æ¯ï¼Œå¦‚æœä¸æ˜¯åˆ™åŸå°ä¸åŠ¨è¿”å›



C è¯­è¨€è§„å®šï¼ŒåŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²æ˜¯ `const char *` ç±»å‹çš„

`using namespace std::literials` å¯ä»¥ä½¿ç”¨ `"hello"s` æ¥å®šä¹‰stringäº†

`<sstream>`ä¸­çš„`stringstream`

to_stringæ¨¡æ¿ï¼š[ã€C++æ ‡å‡†åº“ã€‘std::stringç”¨æ³•æŒ‡å—&æºç å‰–æ](https://www.bilibili.com/video/BV1ja411M7Di/) 1:26:57

cout æœ‰è¾“å‡ºçš„ç²¾åº¦ï¼Œå½“éœ€è¦è¾“å‡ºé«˜ç²¾åº¦çš„æ•°æ—¶(æ¯”å¦‚ 3.14159265358)ï¼Œéœ€è¦ä½¿ç”¨`std::setprecision(100)`æ¥è®¾ç½®ç²¾åº¦



#### `std::stack`



#### `std::queue`



#### `std::set`

Setæ˜¯ç”¨çº¢é»‘æ ‘å®ç°çš„ï¼Œå†…éƒ¨çš„å…ƒç´ ä»å°åˆ°å¤§æ’åºã€‚

setä¸­æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æŸä¸ªå…ƒç´ ï¼š

```cpp
#include <iostream>
#include <set>

int main() {
    std::set<int> a = {1, 2, 3, 4, 5};
    if (a.find(6) != a.end()) {
        std::cout << "6 is in a" << std::endl;
    } else {
        std::cout << "6 is not in a" << std::endl;
    }

    if (a.find(2) != a.end()) {
        std::cout << "2 is in a" << std::endl;
    } else {
        std::cout << "2 is not in a" << std::endl;
    }
    return 0;
}
```

æ›´çŸ­çš„ç”¨æ³•æ˜¯ç”¨`count`ä»£æ›¿`find`

```cpp
#include <iostream>
#include <set>

int main() {
    std::set<int> a = {1, 2, 3, 4, 5};
    if (a.count(6)) {
        std::cout << "6 is in a" << std::endl;
    } else {
        std::cout << "6 is not in a" << std::endl;
    }

    if (a.count(2)) {
        std::cout << "2 is in a" << std::endl;
    } else {
        std::cout << "2 is not in a" << std::endl;
    }
    return 0;
}
```



lower_bound å’Œ upper_bound å‡½æ•°

lower_bound(x) æ‰¾ç¬¬ä¸€ä¸ª**å¤§äºç­‰äº** **x**çš„å…ƒç´ ã€‚

upper_bound(x) æ‰¾ç¬¬ä¸€ä¸ª**å¤§äº** **x**çš„å…ƒç´ ã€‚



å°†setè½¬æ¢ä¸ºvector

```cpp
std::set<int> b = {0, 1, 2, 3, 4};
std::vector<int> arr(b.begin(), b.end());
```



ç»™vectorè‡ªåŠ¨æ’åºå’Œå»é‡ï¼š

```cpp
std::vector<int> arr = {9, 8, 5, 2, 1, 1};
std::set<int> b(arr.begin(), a.end());
arr.assign(b.begin(), b.end());
```



setçš„ä¸å»é‡ç‰ˆæœ¬ï¼šmultiset



| **å‡½æ•°**       | **å«ä¹‰**                       | **set** | **multiset** | **unordered_set** |
| -------------- | ------------------------------ | ------- | ------------ | ----------------- |
| insert(x)      | æ’å…¥ä¸€ä¸ªå…ƒç´   x                | âˆš       | âˆš            | âˆš                 |
| erase(x)       | åˆ é™¤æ‰€æœ‰ç­‰äº  x çš„å…ƒç´          | âˆš       | âˆš            | âˆš                 |
| count(x)       | æœ‰å¤šå°‘ä¸ªç­‰äº  x çš„å…ƒç´          | âˆšï¼Œ0æˆ–1 | âˆš            | âˆšï¼Œ0æˆ–1           |
| find(x)        | æŒ‡å‘ç¬¬ä¸€ä¸ªç­‰äº  x çš„å…ƒç´        | âˆš       | âˆš            | âˆš                 |
| lower_bound(x) | æŒ‡å‘ç¬¬ä¸€ä¸ªå¤§äºç­‰äº  x çš„å…ƒç´    | âˆš       | âˆš            | Ã—                 |
| upper_bound(x) | æŒ‡å‘ç¬¬ä¸€ä¸ªå¤§äº  x çš„å…ƒç´        | âˆš       | âˆš            | Ã—                 |
| equal_range(x) | æ‰€æœ‰ç­‰äº  x çš„å…ƒç´ æ‰€ç»„æˆçš„åŒºé—´ | âˆš       | âˆš            | âˆš                 |



#### `std::map`



### Iteratorï¼ˆè¿­ä»£å™¨ï¼‰

|                | **æä¾›çš„è¿ç®—ç¬¦é‡è½½**                | **å…·æœ‰æ­¤è¿­ä»£å™¨çš„å®¹å™¨** | **ç›¸åº”çš„** **C++20 concept** |
| -------------- | ----------------------------------- | ---------------------- | ---------------------------- |
| è¾“å…¥è¿­ä»£å™¨     | *ï¼ˆå¯è¯»å–ï¼‰ï¼Œ!=ï¼Œ==ï¼Œ++ï¼ˆä¸€æ¬¡æ€§ï¼‰   | istream_iterator       | input_iterator               |
| è¾“å‡ºè¿­ä»£å™¨     | *ï¼ˆå¯å†™å…¥ï¼‰ï¼Œ!=ï¼Œ==ï¼Œ++ï¼ˆä¸€æ¬¡æ€§ï¼‰   | back_insert_iterator   | output_iterator              |
| å‰å‘è¿­ä»£å™¨     | *ï¼Œ!=ï¼Œ==ï¼Œ++                       | forward_list           | forward_iterator             |
| åŒå‘è¿­ä»£å™¨     | *ï¼Œ!=ï¼Œ==ï¼Œ++ï¼Œ--                   | setï¼Œmapï¼Œlist         | bidirectional_iterator       |
| éšæœºè®¿é—®è¿­ä»£å™¨ | *ï¼Œ!=ï¼Œ==ï¼Œ++ï¼Œ--ï¼Œ+ï¼Œ-ï¼Œ+=ï¼Œ-=ï¼Œ[] | vectorï¼Œarrayï¼Œdeque   | random_access_iterator       |
| è¿­ä»£å™¨å¤–åŒ…è£…   | å’Œä»–æ‰€åŒ…è£…çš„è¿­ä»£å™¨ä¿æŒä¸€è‡´          | reverse_iterator       | å’Œæ‰€åŒ…è£…çš„è¿­ä»£å™¨ä¸€è‡´         |

åŒ…å«å…³ç³»ï¼šå‰å‘è¿­ä»£å™¨ï¼åŒå‘è¿­ä»£å™¨ï¼éšæœºè®¿é—®è¿­ä»£å™¨

è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªSTLæ¨¡æ¿å‡½æ•°ï¼ˆæ¯”å¦‚`std::find`ï¼‰è¦æ±‚è¿­ä»£å™¨æ˜¯**å‰å‘è¿­ä»£å™¨**å³å¯ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ç»™ä»–éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œå› ä¸º**å‰å‘è¿­ä»£å™¨**æ˜¯**éšæœºè®¿é—®è¿­ä»£å™¨**çš„å­é›†ã€‚

è¿­ä»£å™¨å¸®æ‰‹å‡½æ•°

| **å¸®æ‰‹å‡½æ•°**                 | **ç­‰ä»·äº**     |
| ---------------------------- | -------------- |
| it2  = std::next(it1, n)     | it2  = it1 + n |
| it2  = std::prev(it1, n)     | it2  = it1 - n |
| it2  = std::next(it1)        | it2  = it1 + 1 |
| it2  = std::prev(it1)        | it2  = it1 - 1 |
| std::advance(it1,  n)        | it1  += n      |
| std::advance(it1,  -n)       | it1  -= n      |
| n =  std::distance(it1, it2) | n =  it2 - it1 |



### Memory

| Type      |      |      |
| --------- | ---- | ---- |
| Automatic |      |      |
| Dynamic   |      |      |
| Thread    |      |      |
| Static    |      |      |

Heapï¼ˆå †ï¼‰

Stackï¼ˆæ ˆï¼‰





åˆå§‹åŒ–åˆ—è¡¨

```cpp
int main() {
    std::vector<int> a = {1, 2, 3, 4, 5};
    a.insert(a.begin(), {-3, -2, -1, 0});
    return 0;
}
```

å…¶ä¸­`{1, 2, 3, 4, 5}`å’Œ`{-3, -2, -1, 0}`å°±æ˜¯åˆå§‹åŒ–åˆ—è¡¨ï¼Œå³`std::initializer_list<int>`ï¼Œæ˜¯`c++11`æ–°å¢çš„å†…å®¹ã€‚



## é¢å‘å¯¹è±¡ç¼–ç¨‹

é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject-Oriented Programmingï¼Œç®€ç§° OOPï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©æŠ½è±¡ä¸ºç¨‹åºä¸­çš„å¯¹è±¡ã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸‰å¤§ç‰¹æ€§æ˜¯å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ã€‚ä¸‹é¢å°†è¯¦ç»†ä»‹ç»è¿™ä¸‰ä¸ªç‰¹æ€§ï¼š

-   **ç»§æ‰¿ï¼ˆInheritanceï¼‰**ï¼š ç»§æ‰¿æ˜¯æŒ‡ä¸€ä¸ªç±»ï¼ˆå­ç±»ï¼‰å¯ä»¥ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆçˆ¶ç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•ã€‚å­ç±»é™¤äº†æ‹¥æœ‰çˆ¶ç±»çš„ç‰¹æ€§å¤–ï¼Œè¿˜å¯ä»¥å…·æœ‰è‡ªå·±ç‰¹æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚è¿™ç§æ–¹å¼å¯ä»¥å®ç°ä»£ç çš„é‡ç”¨å’Œæ¨¡å—åŒ–ï¼Œå‡å°‘é‡å¤ä»£ç çš„ç¼–å†™ã€‚ç»§æ‰¿æœ‰åŠ©äºå®ç°ç±»ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ï¼Œå¹¶æœ‰åŠ©äºç†è§£å’Œç»´æŠ¤ä»£ç ç»“æ„ã€‚
-   **å°è£…ï¼ˆEncapsulationï¼‰**ï¼š å°è£…æ˜¯æŒ‡å°†æ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•åŒ…è£…åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªç‹¬ç«‹çš„â€œå¯¹è±¡â€ã€‚è¿™æ ·çš„è®¾è®¡æœ‰åŠ©äºé™ä½ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œæé«˜å¯ç»´æŠ¤æ€§ã€‚å°è£…çš„ä¸»è¦ç›®çš„æ˜¯å¢å¼ºå®‰å…¨æ€§ï¼Œä¿æŠ¤æ•°æ®ä»¥å…è¢«å¤–éƒ¨ä»£ç éšæ„è®¿é—®å’Œä¿®æ”¹ã€‚ä¸ºæ­¤ï¼Œé€šå¸¸å°†å¯¹è±¡çš„å±æ€§è®¾ä¸ºç§æœ‰ï¼ˆprivateï¼‰æˆ–å—ä¿æŠ¤ï¼ˆprotectedï¼‰ï¼Œå¹¶é€šè¿‡å…¬å…±ï¼ˆpublicï¼‰æ–¹æ³•ï¼ˆå¦‚ getter å’Œ setter æ–¹æ³•ï¼‰æ¥è®¿é—®å’Œä¿®æ”¹è¿™äº›å±æ€§ã€‚
-   **å¤šæ€ï¼ˆPolymorphismï¼‰**ï¼š å¤šæ€æ˜¯æŒ‡å…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯ä½œå‡ºå“åº”ï¼Œå³åŒä¸€æ–¹æ³•åå¯ä»¥åœ¨ä¸åŒç±»ä¸­å…·æœ‰ä¸åŒçš„å®ç°ã€‚å¤šæ€å®ç°çš„ä¸»è¦æ–¹å¼æœ‰ä¸¤ç§ï¼šæ¥å£å®ç°å’Œé‡å†™ï¼ˆè¦†ç›–ï¼‰ã€‚



é¢å‘å¯¹è±¡çš„è®¾è®¡æ¨¡å¼(OOP Design Patterns)

>   Composite, Decorator, Bridge, Visitor, Proxy, FaÃ§ade, ...
>   Iterator, Strategy, Observer, Command, Template Method, ...
>   Factory Method, Abstract Factory, Singleton, ...



### å‘½åç©ºé—´

```cpp
namespace MyNameSpace {
    int foo(int a, int b) {
        return a + b;
    }
};
```

```cpp
std::cout << MyNameSpace::foo(0, 1) << std::endl;
```



### å˜é‡ä½œç”¨åŸŸ

åœ¨C++ä¸­ï¼Œå˜é‡ä½œç”¨åŸŸï¼ˆScopeï¼‰æŒ‡çš„æ˜¯ç¨‹åºä¸­å˜é‡å¯ä»¥è¢«è®¿é—®çš„ä»£ç åŒºåŸŸã€‚ä½œç”¨åŸŸå†³å®šäº†å˜é‡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯è§æ€§ã€‚

1.  **å…¨å±€ä½œç”¨åŸŸ**ï¼šåœ¨å‡½æ•°å¤–éƒ¨å£°æ˜çš„å˜é‡å…·æœ‰å…¨å±€ä½œç”¨åŸŸã€‚å®ƒä»¬å¯ä»¥åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹è¢«è®¿é—®ï¼Œä½†é€šå¸¸å»ºè®®åœ¨éœ€è¦æ—¶æ‰ä½¿ç”¨å…¨å±€å˜é‡ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å¯¼è‡´ä»£ç éš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚
2.  **å±€éƒ¨ä½œç”¨åŸŸ**ï¼šåœ¨å‡½æ•°å†…éƒ¨ã€ä»£ç å—ï¼ˆå¦‚`if`è¯­å¥ã€`for`å¾ªç¯ç­‰ï¼‰å†…éƒ¨å£°æ˜çš„å˜é‡å…·æœ‰å±€éƒ¨ä½œç”¨åŸŸã€‚å®ƒä»¬åªèƒ½åœ¨å£°æ˜å®ƒä»¬çš„ä»£ç å—å†…è¢«è®¿é—®ã€‚ä¸€æ—¦ç¦»å¼€è¯¥ä»£ç å—ï¼Œè¿™äº›å˜é‡å°±ä¸å†å¯è§ã€‚
3.  **å‘½åç©ºé—´ä½œç”¨åŸŸ**ï¼šåœ¨å‘½åç©ºé—´ä¸­å£°æ˜çš„å˜é‡ï¼ˆå®é™…ä¸Šæ˜¯å®ä½“ï¼Œå¦‚å˜é‡ã€å‡½æ•°ç­‰ï¼‰å…·æœ‰å‘½åç©ºé—´ä½œç”¨åŸŸã€‚å®ƒä»¬åªèƒ½åœ¨ç›¸åº”çš„å‘½åç©ºé—´å†…è¢«ç›´æ¥è®¿é—®ï¼Œä½†å¯ä»¥é€šè¿‡ä½¿ç”¨å‘½åç©ºé—´çš„åç§°ä½œä¸ºå‰ç¼€æ¥ä»å¤–éƒ¨è®¿é—®ã€‚
4.  **ç±»ä½œç”¨åŸŸ**ï¼šåœ¨ç±»å†…éƒ¨å£°æ˜çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°å…·æœ‰ç±»ä½œç”¨åŸŸã€‚æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°å¯ä»¥é€šè¿‡ç±»çš„å¯¹è±¡æ¥è®¿é—®ï¼Œæˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆå¦‚é™æ€æˆå‘˜ï¼‰å¯ä»¥é€šè¿‡ç±»åç›´æ¥è®¿é—®ã€‚
5.  **å—ä½œç”¨åŸŸ**ï¼šè¿™æ˜¯å±€éƒ¨ä½œç”¨åŸŸçš„ä¸€ä¸ªç‰¹ä¾‹ï¼ŒæŒ‡çš„æ˜¯ç”±å¤§æ‹¬å·`{}`åŒ…å›´çš„ä»£ç å—å†…éƒ¨å£°æ˜çš„å˜é‡ã€‚è¿™äº›å˜é‡åªèƒ½åœ¨è¯¥ä»£ç å—å†…è¢«è®¿é—®ã€‚



### å˜é‡ç”Ÿå‘½å‘¨æœŸ

-   è‡ªåŠ¨å­˜å‚¨å‘¨æœŸï¼ˆæ ˆä¸Šï¼‰ - å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œè‡ªåŠ¨ææ„
-   åŠ¨æ€å­˜å‚¨å‘¨æœŸï¼ˆå †ä¸Šï¼‰ - é€šè¿‡ new åˆ›å»ºçš„å˜é‡ï¼Œdelete æ—¶ææ„
-   é™æ€å­˜å‚¨å‘¨æœŸï¼ˆstatic å’Œ inlineï¼‰ - å…¨å±€å˜é‡ï¼Œç¨‹åºç»“æŸæ—¶ææ„



### å­˜å‚¨åŒºåŸŸ

åœ¨C++ä¸­ï¼Œå†…å­˜å­˜å‚¨é€šå¸¸å¯ä»¥å¤§è‡´åˆ†ä¸ºå‡ ä¸ªåŒºåŸŸï¼Œè¿™äº›åŒºåŸŸæ ¹æ®å­˜å‚¨çš„æ•°æ®ç±»å‹ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸæ¥åˆ’åˆ†ã€‚è¿™äº›åŒºåŸŸä¸»è¦åŒ…æ‹¬ï¼š

1.  ä»£ç åŒºï¼ˆCode Segment/Text Segmentï¼‰
    *   å­˜å‚¨ç¨‹åºæ‰§è¡Œä»£ç ï¼ˆå³æœºå™¨æŒ‡ä»¤ï¼‰çš„å†…å­˜åŒºåŸŸã€‚è¿™éƒ¨åˆ†å†…å­˜æ˜¯å…±äº«çš„ï¼Œåªè¯»çš„ï¼Œä¸”åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜ã€‚
    *   ä¸¾ä¾‹è¯´æ˜ï¼šå½“ä½ ç¼–è¯‘ä¸€ä¸ªC++ç¨‹åºæ—¶ï¼Œæ‰€æœ‰çš„å‡½æ•°å®šä¹‰ã€æ§åˆ¶ç»“æ„ç­‰éƒ½ä¼šè¢«è½¬æ¢æˆæœºå™¨æŒ‡ä»¤ï¼Œå¹¶å­˜å‚¨åœ¨ä»£ç åŒºã€‚
2.  å…¨å±€/é™æ€å­˜å‚¨åŒºï¼ˆGlobal/Static Storage Areaï¼‰
    *   å­˜å‚¨å…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„å†…å­˜åŒºåŸŸã€‚è¿™äº›å˜é‡åœ¨ç¨‹åºçš„æ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ï¼Œä½†å®ƒä»¬çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸå–å†³äºå£°æ˜å®ƒä»¬çš„ä½œç”¨åŸŸã€‚
    *   ä¸¾ä¾‹è¯´æ˜ï¼šå…¨å±€å˜é‡ï¼ˆåœ¨å‡½æ•°å¤–éƒ¨å£°æ˜çš„å˜é‡ï¼‰å’Œé™æ€å˜é‡ï¼ˆä½¿ç”¨`static`å…³é”®å­—å£°æ˜çš„å˜é‡ï¼Œæ— è®ºæ˜¯åœ¨å‡½æ•°å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ï¼‰éƒ½ä¼šå­˜å‚¨åœ¨è¿™ä¸ªåŒºåŸŸã€‚
3.  æ ˆåŒºï¼ˆStack Segmentï¼‰
    *   å­˜å‚¨å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°ã€è¿”å›åœ°å€ç­‰çš„å†…å­˜åŒºåŸŸã€‚æ ˆæ˜¯ä¸€ç§åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„æ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨å‡½æ•°è°ƒç”¨å’Œè‡ªåŠ¨å˜é‡ã€‚
    *   ä¸¾ä¾‹è¯´æ˜ï¼šåœ¨å‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡ï¼ˆä¸åŒ…æ‹¬é™æ€å˜é‡ï¼‰é€šå¸¸å­˜å‚¨åœ¨æ ˆä¸Šã€‚å½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå…¶å‚æ•°å’Œå±€éƒ¨å˜é‡ä¼šè¢«æ¨å…¥æ ˆä¸­ï¼›å½“å‡½æ•°è¿”å›æ—¶ï¼Œè¿™äº›å˜é‡ä¼šä»æ ˆä¸­å¼¹å‡ºï¼Œå…¶å ç”¨çš„å†…å­˜ä¹Ÿéšä¹‹é‡Šæ”¾ã€‚
4.  å †åŒºï¼ˆHeap Segmentï¼‰
    *   ç”±ç¨‹åºå‘˜é€šè¿‡åŠ¨æ€å†…å­˜åˆ†é…å‡½æ•°ï¼ˆå¦‚`new`å’Œ`malloc`ï¼‰åˆ†é…çš„å†…å­˜åŒºåŸŸã€‚å †åŒºçš„å†…å­˜åˆ†é…å’Œé‡Šæ”¾æ˜¯æ‰‹åŠ¨çš„ï¼Œå› æ­¤ç¨‹åºå‘˜éœ€è¦è´Ÿè´£ç®¡ç†å†…å­˜ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼æˆ–é‡æŒ‡é’ˆç­‰é—®é¢˜ã€‚
    *   ä¸¾ä¾‹è¯´æ˜ï¼šå½“ä½ ä½¿ç”¨`new`æ“ä½œç¬¦åœ¨C++ä¸­åŠ¨æ€åˆ†é…ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼Œåˆ†é…çš„å†…å­˜å°±æ¥è‡ªå †åŒºã€‚åŒæ ·ï¼Œä½¿ç”¨`delete`æ“ä½œç¬¦å¯ä»¥é‡Šæ”¾å †åŒºä¸­çš„å†…å­˜ã€‚
5.  å¸¸é‡åŒºï¼ˆConstant Areaï¼‰
    *   å­˜å‚¨å¸¸é‡ï¼ˆå¦‚å­—ç¬¦ä¸²å¸¸é‡ã€constä¿®é¥°çš„å…¨å±€å˜é‡ç­‰ï¼‰çš„å†…å­˜åŒºåŸŸã€‚è¿™éƒ¨åˆ†å†…å­˜ä¹Ÿæ˜¯åªè¯»çš„ï¼Œä¸”é€šå¸¸åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜ã€‚
    *   ä¸¾ä¾‹è¯´æ˜ï¼šåœ¨C++ä¸­ï¼Œä½¿ç”¨åŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²å­—é¢é‡é€šå¸¸å­˜å‚¨åœ¨å¸¸é‡åŒºã€‚æ­¤å¤–ï¼Œä½¿ç”¨`const`å…³é”®å­—å£°æ˜çš„å…¨å±€å˜é‡ï¼Œå¦‚æœå…¶å€¼åœ¨ç¼–è¯‘æ—¶å°±å·²ç¡®å®šï¼Œä¹Ÿå¯èƒ½å­˜å‚¨åœ¨å¸¸é‡åŒºã€‚



## Class

[ç±»é¢è¯•å¸¸è§é—®é¢˜](https://gitbookcpp.llfc.club/sections/cpp/base/cppbase21.html)

### æ„é€ å‡½æ•°(Constructor)

è¯¦è§ï¼š[Class](./Class.md)

1.   é»˜è®¤æ„é€ å‡½æ•°(Default Constructor)
     ```cpp
     class MyClass {
     public:
         // æ˜¾å¼å®šä¹‰é»˜è®¤æ„é€ å‡½æ•°
         MyClass() {
             data = 0;  // åˆå§‹åŒ–æˆå‘˜
         }
     private:
         int data;
     };
     // ä½¿ç”¨ï¼šMyClass obj;
     ```

2.   å¸¦å‚æ„é€ å‡½æ•°(Parameterized Constructor)
     ```cpp
     class Point {
     public:
         Point(int x, int y) : x_(x), y_(y) {}  // ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨
     private:
         int x_, y_;
     };
     // ä½¿ç”¨ï¼šPoint p(10, 20);
     ```

3.   æ‹·è´æ„é€ å‡½æ•°(Copy Constructor)
     ```cpp
     MyTime::MyTime(MyTime &t){...}
     
     int main()
     {
         MyTime t1(1, 59);
         MyTime t2(t1);  // copy constructor
         MyTime t3 = t1;  // copy constructor
     }
     ```

     å¦‚æœæ²¡æœ‰å®šä¹‰ copy constructor ç¼–è¯‘å™¨é»˜è®¤ç”Ÿæˆä¸€ä¸ª,  copy constructor ä¼šå¤åˆ¶æ‰€æœ‰éé™æ€æˆå‘˜.

4.   æ‹·è´èµ‹å€¼æ„é€ å‡½æ•°(copy assignment constructor)
     ```cpp
     MyTime &MyTime::operator=(MyTime &){...}
     
     int main()
     {
         MyTime t1(1, 59);
         MyTime t2 = t1;  // copy constructor
         t2 = t1;  // copy assignment
     }
     ```

     å¦‚æœæ²¡æœ‰å®šä¹‰ copy assignment constructor ç¼–è¯‘å™¨é»˜è®¤ç”Ÿæˆä¸€ä¸ª, copy assignment constructor ä¼šå¤åˆ¶æ‰€æœ‰éé™æ€æˆå‘˜.

5.   ç§»åŠ¨æ„é€ å‡½æ•°(Move Constructor)
     ```cpp
     class Array {
     public:
         Array(Array&& other) noexcept 
             : data_(other.data_), size_(other.size_) {
             other.data_ = nullptr;  // ç½®ç©ºåŸæŒ‡é’ˆï¼Œé˜²æ­¢èµ„æºé‡Šæ”¾
             other.size_ = 0;
         }
     private:
         int* data_;
         int size_;
     };
     // ä½¿ç”¨ï¼šArray a2 = std::move(a1); // ç§»åŠ¨è¯­ä¹‰
     ```



#### Rule of Three/Five (ä¸‰/äº”æ³•åˆ™)

1.  **Rule of Three (C++98/03)ï¼š** å¦‚æœä¸€ä¸ªç±»éœ€è¦æ˜¾å¼åœ°å®šä¹‰ä»¥ä¸‹å…¶ä¸­ä¸€é¡¹ï¼š
    *   **ææ„å‡½æ•° (Destructor)**
    *   **æ‹·è´æ„é€ å‡½æ•° (Copy Constructor)**
    *   **æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (Copy Assignment Operator)**
        é‚£ä¹ˆå®ƒå¾ˆå¯èƒ½ä¹Ÿéœ€è¦æ˜¾å¼åœ°å®šä¹‰**å…¨éƒ¨ä¸‰é¡¹**ã€‚
        **ä¸ºä»€ä¹ˆï¼Ÿ** è¿™é€šå¸¸æ„å‘³ç€ä½ çš„ç±»æ­£åœ¨ç®¡ç†æŸç§èµ„æºï¼ˆåŠ¨æ€å†…å­˜ã€æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ã€é”ç­‰ï¼‰ã€‚ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤æ‹·è´æ“ä½œï¼ˆæµ…æ‹·è´ï¼‰å¯¹äºèµ„æºç®¡ç†ç±»é€šå¸¸æ˜¯é”™è¯¯çš„ï¼Œä¼šå¯¼è‡´åŒé‡é‡Šæ”¾ã€èµ„æºæ³„æ¼ç­‰é—®é¢˜ã€‚å¦‚æœä½ å®šä¹‰äº†ææ„å‡½æ•°æ¥é‡Šæ”¾èµ„æºï¼Œå°±å¿…é¡»ç¡®ä¿æ‹·è´æ“ä½œä¹Ÿèƒ½æ­£ç¡®å¤„ç†èµ„æºï¼ˆé€šå¸¸æ˜¯æ·±æ‹·è´æˆ–ç¦æ­¢æ‹·è´ï¼‰ã€‚

2.  **Rule of Five (C++11 åŠä»¥å)ï¼š** åœ¨ Rule of Three çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å¯¹ç§»åŠ¨è¯­ä¹‰çš„æ”¯æŒã€‚å¦‚æœä¸€ä¸ªç±»éœ€è¦æ˜¾å¼åœ°å®šä¹‰ä»¥ä¸‹å…¶ä¸­ä¸€é¡¹ï¼š
    *   ææ„å‡½æ•°
    *   æ‹·è´æ„é€ å‡½æ•°
    *   æ‹·è´èµ‹å€¼è¿ç®—ç¬¦
    *   **ç§»åŠ¨æ„é€ å‡½æ•° (Move Constructor)**
    *   **ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (Move Assignment Operator)**
        é‚£ä¹ˆå®ƒå¾ˆå¯èƒ½ä¹Ÿéœ€è¦æ˜¾å¼åœ°å®šä¹‰**å…¨éƒ¨äº”é¡¹**ï¼ˆæˆ–è€…ä»”ç»†è€ƒè™‘å“ªäº›éœ€è¦å®šä¹‰ï¼Œå“ªäº›éœ€è¦åˆ é™¤ `=delete`ï¼Œå“ªäº›å¯ä»¥ç”¨é»˜è®¤ `=default`ï¼‰ã€‚
        **ä¸ºä»€ä¹ˆï¼Ÿ** ç§»åŠ¨è¯­ä¹‰å…è®¸é«˜æ•ˆåœ°â€œçªƒå–â€èµ„æºã€‚å¦‚æœä½ å®šä¹‰äº†ææ„å‡½æ•°ï¼ˆè¡¨æ˜ç®¡ç†èµ„æºï¼‰ï¼Œå¹¶ä¸”ä½ å¸Œæœ›ä½ çš„ç±»æ”¯æŒé«˜æ•ˆçš„ç§»åŠ¨æ“ä½œï¼ˆè€Œä¸æ˜¯å›é€€åˆ°æ‹·è´ï¼‰ï¼Œé‚£ä¹ˆä½ éœ€è¦å®šä¹‰ç§»åŠ¨æ„é€ å’Œç§»åŠ¨èµ‹å€¼æ¥æ­£ç¡®åœ°è½¬ç§»èµ„æºæ‰€æœ‰æƒã€‚åŒæ—¶ï¼Œä½ ä¹Ÿéœ€è¦ç¡®ä¿æ‹·è´æ“ä½œçš„è¡Œä¸ºæ˜¯æ­£ç¡®çš„ï¼ˆæ·±æ‹·è´æˆ–ç¦æ­¢ï¼‰ã€‚



### ææ„å‡½æ•°

:warning:**è™šç±»çš„ææ„å‡½æ•°å¿…é¡»æ˜¯è™šçš„**

:warning:**ææ„å‡½æ•°çš„é€†å¤©å¤§å‘**

å®šä¹‰äº†ææ„å‡½æ•°ï¼Œå°±**å¿…é¡»åˆ é™¤ç§»åŠ¨æ„é€ å‡½æ•°ã€ç§»åŠ¨èµ‹å€¼å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°ã€æ‹·è´èµ‹å€¼å‡½æ•°**ï¼

åŸå› å¾ˆå¤æ‚ï¼Œæ•´ä¸ªæ•…äº‹è¦ä» boost å½“å¹´å¦‚ä½•è®¾è®¡å‡ºå³å€¼å¼•ç”¨åˆ°å›¾çµçš„åœæœºé—®é¢˜è®²èµ·ï¼Œè®²äº†ä½ ä¹Ÿè®°ä¸ä½ï¼Œåªéœ€è¦è®°ä½ç»“è®ºï¼š

å¦‚æœä½ è¦å®šä¹‰ææ„å‡½æ•°ï¼Œå°±**å¿…é¡»åˆ é™¤ç§»åŠ¨æ„é€ å‡½æ•°ã€ç§»åŠ¨èµ‹å€¼å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°ã€æ‹·è´èµ‹å€¼å‡½æ•°**ï¼



### ç±»çš„ç»§æ‰¿

ç»§æ‰¿ç±»å‹ï¼š

*   public ç»§æ‰¿
*   protected ç»§æ‰¿
*   private ç»§æ‰¿

#### å®šä¹‰ä¸èƒ½è¢«ç»§æ‰¿çš„ç±»

åœ¨ C++ ä¸­ï¼Œè¦è®¾è®¡ä¸€ä¸ªä¸èƒ½è¢«ç»§æ‰¿çš„ç±»ï¼Œå¯ä»¥ä½¿ç”¨**å…³é”®å­—** `final`ã€‚å°† `final` å…³é”®å­—æ·»åŠ åˆ°ç±»å®šä¹‰ä¸­ï¼Œå¯ä»¥é˜»æ­¢å…¶ä»–ç±»ç»§æ‰¿è¿™ä¸ªç±»ã€‚å¦‚æœå°è¯•ç»§æ‰¿å¸¦æœ‰ `final` å…³é”®å­—çš„ç±»ï¼Œç¼–è¯‘å™¨å°†æŠ¥é”™ã€‚

```cpp
class NonInheritable final {
public:
    // ç±»çš„æˆå‘˜å’Œæ–¹æ³•å®šä¹‰
};
```

`final` å…³é”®å­—æ·»åŠ åˆ°ç±»å®šä¹‰ä¸­ï¼Œå¯ä»¥ç¡®ä¿ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä»è€Œå®ç°ç±»çš„å°é—­æ€§ã€‚



## è¿ç®—ç¬¦é‡è½½(operator overloading)

### è¿ç®—ç¬¦é‡è½½çš„æ–¹æ³•

åœ¨C++ä¸­ï¼Œè¿ç®—ç¬¦å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•°æˆ–éæˆå‘˜å‡½æ•°ï¼ˆé€šå¸¸æ˜¯å‹å…ƒå‡½æ•°ï¼‰æ¥é‡è½½ã€‚

#### æˆå‘˜å‡½æ•°æ–¹å¼

è¿ç®—ç¬¦ä½œä¸ºç±»çš„æˆå‘˜å‡½æ•°è¿›è¡Œé‡è½½æ—¶ï¼Œå·¦æ“ä½œæ•°æ˜¯å½“å‰å¯¹è±¡ï¼ˆ`this`ï¼‰ã€‚å› æ­¤ï¼Œå¯¹äºéœ€è¦ä¿®æ”¹å·¦æ“ä½œæ•°çš„è¿ç®—ç¬¦ï¼Œæˆå‘˜å‡½æ•°æ–¹å¼é€šå¸¸æ›´ç›´è§‚ã€‚

```cpp
class ClassName {
public:
    ClassName operator+(const ClassName& other);
};
```



#### éæˆå‘˜å‡½æ•°æ–¹å¼(å‹å…ƒå‡½æ•°)

å½“éœ€è¦å¯¹ä¸¤ä¸ªä¸åŒç±»å‹çš„å¯¹è±¡è¿›è¡Œè¿ç®—ï¼Œæˆ–è€…å·¦æ“ä½œæ•°ä¸æ˜¯å½“å‰ç±»çš„å¯¹è±¡æ—¶ï¼Œé€šå¸¸ä½¿ç”¨éæˆå‘˜å‡½æ•°æ–¹å¼ã€‚ä¸ºäº†è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜ï¼Œéæˆå‘˜å‡½æ•°é€šå¸¸è¢«å£°æ˜ä¸ºç±»çš„å‹å…ƒå‡½æ•°ã€‚

```c++
class ClassName {
    friend ClassName operator+(const ClassName* lhs, const ClassName& rhs);
};
```



#### ç¤ºä¾‹

```cpp title="Complex.cpp"
#include <iostream>

class Complex {
public:
    // æ„é€ å‡½æ•°
    Complex(double real = 0.0, double imag = 0.0) : real_(real), imag_(imag) {}
    // é‡è½½ "+" è¿ç®—ç¬¦(æˆå‘˜å‡½æ•°)
    Complex operator+(const Complex& other) const {
        return Complex(this->real_ + other.real_, this->imag_ + other.imag_);
    }
    // é‡è½½ "<<" è¿ç®—ç¬¦ç”¨äºè¾“å‡º
    friend std::ostream& operator<<(std::ostream& os, const Complex& c) {
        os << "(" << c.real_;
        if (c.imag_ >= 0) os << " + " << c.imag_ << "i)";
        else os << " - " << -c.imag_ << "i)";
        return os;
    }
private:
    double real_;
    double imag_;
};

int main() {
    Complex c1(3.0, 2.0);
    Complex c2(1.5, -2.5);
    Complex c3 = c1 + c2;
    std::cout << "c1 + c2 = " << c3 << std::endl;
    return 0;
}
```

æ›´å¤šå†…å®¹è¯·è§ï¼š[https://gitbookcpp.llfc.club/sections/cpp/base/cppbase30.html](https://gitbookcpp.llfc.club/sections/cpp/base/cppbase30.html)

## æ¨¡æ¿(Template)

ä½¿ç”¨

```cpp
template <typename T>
```

æˆ–

```cpp
template <class T>
```

### æ¨¡æ¿åŸºç¡€

#### æ¨¡æ¿å‡½æ•°(Template Function)

```cpp
template <typename T>
T Vector3<T>::getMax() {
    T temp = m_vec[0] > m_vec[1] ? m_vec[0] : m_vec[1];
    return temp > m_vec[2] ? temp : m_vec[2];
}
```



#### æ¨¡æ¿ç±»(Template Class)

```cpp
template <typename T>
class Vector3 {
public:
    Vector3(T v1, T v2, T v3) {
        m_vec[0] = v1;
        m_vec[1] = v2;
        m_vec[2] = v3;
    }
    T getMax();
private:
    T m_vec[3];
};
```

### æ¨¡æ¿å‚æ•°

#### ç±»å‹å‚æ•°



#### éç±»å‹å‚æ•°



#### æ¨¡æ¿æ¨¡æ¿å‚æ•°



å…¶ä»–æ›´å¤šæ¨¡æ¿å†…å®¹è¯·è§ï¼š[https://gitbookcpp.llfc.club/sections/cpp/base/cppbase31.html](https://gitbookcpp.llfc.club/sections/cpp/base/cppbase31.html)



## RAII(Resource Acquisition Is Initialization)

**RAIIï¼ˆResource Acquisition Is Initializationï¼‰** æ˜¯ C++ çš„æ ¸å¿ƒç¼–ç¨‹èŒƒå¼ï¼Œç›´è¯‘ä¸ºâ€œèµ„æºè·å–å³åˆå§‹åŒ–â€ã€‚å®ƒåˆ©ç”¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†èµ„æºï¼ˆå¦‚å†…å­˜ã€æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ç­‰ï¼‰ï¼Œç¡®ä¿èµ„æºå®‰å…¨è·å–å’Œè‡ªåŠ¨é‡Šæ”¾ï¼Œé¿å…æ³„æ¼ã€‚æ ¸å¿ƒæ€æƒ³ï¼š**èµ„æºåœ¨æ„é€ å‡½æ•°ä¸­è·å–ï¼Œåœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾**ã€‚

### æ ¸å¿ƒåŸç†

1. æ„é€ æ—¶è·å–èµ„æºï¼ˆAcquisitionï¼‰
2. ææ„æ—¶é‡Šæ”¾èµ„æºï¼ˆReleaseï¼‰
3. å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»‘å®šèµ„æºç®¡ç†

### å…¸å‹åº”ç”¨åœºæ™¯

```cpp
#include <iostream>
#include <fstream> // æ ‡å‡†åº“ä¸­çš„ RAII èŒƒä¾‹

// ç¤ºä¾‹ 1ï¼šæ–‡ä»¶æ“ä½œï¼ˆè‡ªåŠ¨å…³é—­ï¼‰
void readFile() {
    std::ifstream file("data.txt"); // æ„é€ æ—¶æ‰“å¼€æ–‡ä»¶ï¼ˆè·å–èµ„æºï¼‰
    std::string line;
    while (std::getline(file, line)) {
        std::cout << line << "\n";
    }
} // ç¦»å¼€ä½œç”¨åŸŸæ—¶ file ææ„ â†’ è‡ªåŠ¨å…³é—­æ–‡ä»¶ï¼ˆé‡Šæ”¾èµ„æºï¼‰

// ç¤ºä¾‹ 2ï¼šå†…å­˜ç®¡ç†ï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼‰
#include <memory>
void manageMemory() {
    auto ptr = std::make_unique<int>(42); // æ„é€ æ—¶åˆ†é…å†…å­˜
    // ä½¿ç”¨ ptr...
} // ç¦»å¼€ä½œç”¨åŸŸæ—¶ unique_ptr ææ„ â†’ è‡ªåŠ¨é‡Šæ”¾å†…å­˜

// ç¤ºä¾‹ 3ï¼šè‡ªå®šä¹‰é”ç®¡ç†
class MutexLock {
public:
    MutexLock(Mutex& m) : mutex(m) { mutex.lock(); } // æ„é€ æ—¶åŠ é”
    ~MutexLock() { mutex.unlock(); }                // ææ„æ—¶è§£é”
private:
    Mutex& mutex;
};

void safeWrite() {
    Mutex m;
    {
        MutexLock lock(m); // è¿›å…¥ä½œç”¨åŸŸæ—¶åŠ é”
        // ä¸´ç•ŒåŒºæ“ä½œ...
    } // ç¦»å¼€ä½œç”¨åŸŸæ—¶ lock ææ„ â†’ è‡ªåŠ¨è§£é”
}
```

### RAII çš„æ ¸å¿ƒä¼˜åŠ¿

| ä¼˜åŠ¿             | è¯´æ˜                           |
| ---------------- | ------------------------------ |
| **å¼‚å¸¸å®‰å…¨**     | å³ä½¿æŠ›å‡ºå¼‚å¸¸ï¼Œææ„å‡½æ•°ä»ä¼šè°ƒç”¨ |
| **é¿å…æ³„æ¼**     | èµ„æºé‡Šæ”¾ç”±ç¼–è¯‘å™¨ä¿è¯           |
| **ç®€åŒ–ä»£ç **     | æ— éœ€æ‰‹åŠ¨é‡Šæ”¾èµ„æº               |
| **å¼ºèµ„æºæ‰€æœ‰æƒ** | èµ„æºä¸å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»‘å®š         |

### ä¸æ‰‹åŠ¨ç®¡ç†çš„å¯¹æ¯”

```cpp
// é RAII é£æ ¼ï¼ˆå±é™©ï¼ï¼‰
void unsafeExample() {
    int* arr = new int[100]; // æ‰‹åŠ¨åˆ†é…
    // ... ä½¿ç”¨ arr
    delete[] arr; // å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾ï¼ˆå¯èƒ½å¿˜è®°æˆ–å› å¼‚å¸¸è·³è¿‡ï¼‰
}

// RAII é£æ ¼ï¼ˆå®‰å…¨ï¼‰
void safeExample() {
    std::vector<int> arr(100); // æ„é€ æ—¶åˆ†é…
    // ... ä½¿ç”¨ arr
} // è‡ªåŠ¨é‡Šæ”¾ï¼ˆå³ä½¿æŠ›å‡ºå¼‚å¸¸ï¼‰
```

### **RAII çš„æœ€ä½³å®è·µ**

1. **ä¼˜å…ˆä½¿ç”¨æ ‡å‡†åº“å·¥å…·**
    - å†…å­˜ç®¡ç†ï¼š`std::unique_ptr`, `std::shared_ptr`, `std::vector`
    - æ–‡ä»¶å¤„ç†ï¼š`std::ifstream`/`std::ofstream`
    - çº¿ç¨‹åŒæ­¥ï¼š`std::lock_guard`

2. **è‡ªå®šä¹‰ RAII ç±»**
    - æ„é€ å‡½æ•°è·å–èµ„æºï¼ˆæ‰“å¼€æ–‡ä»¶ã€åˆ†é…å†…å­˜ã€åŠ é”ï¼‰
    - ææ„å‡½æ•°é‡Šæ”¾èµ„æºï¼ˆå…³é—­æ–‡ä»¶ã€é‡Šæ”¾å†…å­˜ã€è§£é”ï¼‰
    - ç¦ç”¨å¤åˆ¶/ç§»åŠ¨ï¼ˆæˆ–å®ç°æ·±æ‹·è´/è½¬ç§»æ‰€æœ‰æƒï¼‰

3. **éµå¾ªè§„åˆ™ä¸‰/äº”/é›¶**
    - ç®¡ç†èµ„æºæ—¶éœ€æ­£ç¡®å¤„ç†æ‹·è´/ç§»åŠ¨è¯­ä¹‰

> ğŸ“Œ **å…³é”®ç»“è®º**ï¼šRAII æ˜¯ C++ åŒºåˆ«äºå…¶ä»–è¯­è¨€çš„æ ¸å¿ƒç‰¹æ€§ï¼Œå®ƒé€šè¿‡å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨åŒ–èµ„æºç®¡ç†ï¼Œæ˜¯ç°ä»£ C++ é¿å…èµ„æºæ³„æ¼çš„åŸºçŸ³ã€‚å‡ ä¹æ‰€æœ‰ C++ æ ‡å‡†åº“ç»„ä»¶ï¼ˆå®¹å™¨ã€æ™ºèƒ½æŒ‡é’ˆã€æµç­‰ï¼‰éƒ½åŸºäº RAII å®ç°ã€‚



## è™šå‡½æ•° (virtual functions)

è™šå‡½æ•°ï¼ˆVirtual Functionï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œä¸»è¦ç”¨äºå®ç°å¤šæ€ï¼ˆPolymorphismï¼‰ã€‚è™šå‡½æ•°å…è®¸åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨æ´¾ç”Ÿç±»çš„æˆå‘˜å‡½æ•°ï¼Œä»è€Œå®ç°äº†å¯¹å‡½æ•°çš„åŠ¨æ€ç»‘å®šã€‚è¿™ç§ç»‘å®šæ–¹å¼ä½¿å¾—ç¨‹åºåœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹æ¥é€‰æ‹©è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œæé«˜äº†ä»£ç çš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚

æ³¨æ„äº‹é¡¹

- æ„é€ å‡½æ•°ä¸èƒ½ä¸ºè™šå‡½æ•°ã€‚
- ææ„å‡½æ•°ï¼ˆDestructorï¼‰ä¹Ÿåº”è¯¥å£°æ˜ä¸ºè™šå‡½æ•°ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åœ¨åˆ é™¤åŸºç±»æŒ‡é’ˆæŒ‡å‘çš„æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œæ´¾ç”Ÿç±»çš„ææ„å‡½æ•°èƒ½å¤Ÿè¢«æ­£ç¡®è°ƒç”¨ï¼Œé¿å…å†…å­˜æ³„æ¼ç­‰é—®é¢˜ã€‚
- å¦‚æœåŸºç±»çš„è™šå‡½æ•°æ²¡æœ‰åœ¨æ´¾ç”Ÿç±»ä¸­è¦†ç›–(override)ï¼Œåˆ™åœ¨è°ƒç”¨è™šå‡½æ•°æ—¶ä¼šæ‰§è¡ŒåŸºç±»ä¸­çš„å®ç°ã€‚
- è™šå‡½æ•°å¯ä»¥æœ‰é»˜è®¤å®ç°ï¼Œä½†ä¹Ÿå¯ä»¥å£°æ˜ä¸ºçº¯è™šå‡½æ•°ï¼ˆPure Virtual Functionï¼‰ã€‚çº¯è™šå‡½æ•°åœ¨åŸºç±»ä¸­æ²¡æœ‰å®ç°ï¼Œæ´¾ç”Ÿç±»å¿…é¡»è¦†ç›–è¿™äº›å‡½æ•°ã€‚å£°æ˜çº¯è™šå‡½æ•°çš„æ–¹æ³•æ˜¯åœ¨å‡½æ•°å£°æ˜åæ·»åŠ `= 0`ã€‚å¦‚æœä¸€ä¸ªç±»åŒ…å«è‡³å°‘ä¸€ä¸ªçº¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±æ˜¯æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰ï¼Œä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ã€‚

```cpp
#include <iostream>
#include <string>

// åŒ…å«è‡³å°‘ä¸€ä¸ªçº¯è™šå‡½æ•°ï¼Œè¿™ä¸ªç±»ä¸ºæŠ½è±¡ç±»(Abstract Class)
class Base {
public:
    virtual ~Base() = default;  // åŸºç±»æ·»åŠ è™šææ„å‡½æ•°
    // çº¯è™šå‡½æ•°(Pure Virtual Function)
    virtual void pure_virtual_func() = 0;
};

class Person {
public:
    virtual ~Person() = default;
    std::string name;
    Person(std::string n): name(n){}
    virtual void print() {
        std::cout << "Name: " << name << std::endl;
    }
};

class Student: public Person {
public:
    std::string id;
    Student(std::string n, std::string i): Person(n), id(i){}
    void print() override {
        std::cout << "Name: " << name << ". ID: " << id << std::endl;
    }
};

void printObjectInfo(Person &p) {
    p.print();
}

int main() {
    {
        Student stu("long", "2000");
        printObjectInfo(stu);
    }

    {
        Person *p = new Student("xing", "1225");
        p->print();
        delete p;
    }
    return 0;
}
```

[è®©è™šå‡½æ•°å†æ¬¡ä¼Ÿå¤§ï¼](https://parallel101.github.io/cppguidebook/design_virtual/)

**æ€»ç»“**

å¸¦æœ‰è™šå‡½æ•°ï¼ˆå‰é¢åŠ å…¥`virtual`ï¼‰çš„ç±»ï¼Œç¼–è¯‘å™¨ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªè™šå‡½æ•°è¡¨ï¼Œé‡Œé¢è®°å½•çš„æ˜¯è™šå‡½æ•°çš„å‡½æ•°çš„åœ°å€ã€‚å½“è¯¥ç±»è¢«ç»§æ‰¿æ—¶ï¼Œå­ç±»å¦‚æœé‡å†™äº†è™šå‡½æ•°å°±åœ¨å­ç±»çš„è™šå‡½æ•°è¡¨ä¸­å°†çˆ¶ç±»çš„è™šå‡½æ•°è¦†ç›–ï¼Œå¦åˆ™ç»§æ‰¿çˆ¶ç±»çš„è™šå‡½æ•°åœ°å€ã€‚

å®ä¾‹åŒ–ä¹‹åï¼Œå†…å­˜åˆ†é…ç»™å¯¹è±¡è™šå‡½æ•°æŒ‡é’ˆ+æˆå‘˜å˜é‡ï¼Œè™šå‡½æ•°æŒ‡é’ˆæŒ‡å‘è™šå‡½æ•°è¡¨ï¼Œè¿™æ ·ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œé€šè¿‡è™šå‡½æ•°æŒ‡é’ˆæ‰¾åˆ°è™šå‡½æ•°è¡¨å°±æ˜¯æ ¹æ®å¯¹è±¡çš„ç±»å‹æ¥æŒ‡å‘çš„ï¼Œä¹Ÿå°±æ˜¯å®ç°äº†`è¿è¡Œæ—¶å¤šæ€`ã€‚

### å¤šæ€





## å¹¶è¡Œç¼–ç¨‹

è¯¦è§ï¼š[å¹¶è¡Œç¼–ç¨‹](./å¹¶è¡Œç¼–ç¨‹.md)



## æ³›å‹ç¼–ç¨‹

è¯¦è§ï¼š[æ³›å‹ç¼–ç¨‹](./æ³›å‹ç¼–ç¨‹.md)



## å†…å­˜ç®¡ç†

è¯¦è§ï¼š[å†…å­˜ç®¡ç†](./å†…å­˜ç®¡ç†.md)



## è®¾è®¡æ¨¡å¼

è¯¦è§ï¼š[å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼](./å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼.md)



## æ‹¾é—

### `explicit` å…³é”®å­—



### `noexcept` å…³é”®å­—



### Containers library

Sequence containersï¼š

Associative containersï¼š

Unordered associate containersï¼š



`queue` å’Œ `priority_queue`

`map` å’Œ `unordered_map`



### æ„é€ å‡½æ•°

é»˜è®¤æ„é€ å‡½æ•°

è‡ªå®šä¹‰æ„é€ å‡½æ•°

æ‹·è´æ„é€ å‡½æ•°

ç§»åŠ¨æ„é€ å‡½æ•°





### æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„è°ƒç”¨é¡ºåº

```cpp
#include <iostream>
struct A {
    A()  { std::cout << "A ctor\n"; }
    ~A() { std::cout << "A dtor\n"; }
};

struct B {
    B()  { std::cout << "B ctor\n"; }
    ~B() { std::cout << "B dtor\n"; }
};

struct C : public A {
    B b;
    C()  { std::cout << "C ctor\n"; }
    ~C() { std::cout << "C dtor\n"; }
};

int main() {
    C c;
}
```

è¿è¡Œç»“æœï¼š

```cpp
A ctor   // å…ˆæ„é€ åŸºç±» A
B ctor   // ç„¶åæ„é€ æˆå‘˜ b
C ctor   // æœ€åæ‰§è¡Œæ´¾ç”Ÿç±» C è‡ªå·±çš„æ„é€ ä½“
C dtor   // ææ„æ—¶å…ˆæ‰§è¡Œ C çš„ææ„ä½“
B dtor   // å†ææ„æˆå‘˜ b
A dtor   // æœ€åææ„åŸºç±» A
```

æ€»ç»“ï¼š

-   **æ„é€ **ï¼šå…ˆåŸºç±» â†’ å†æˆå‘˜ â†’ å†æ´¾ç”Ÿç±»è‡ªå·±ã€‚
-   **ææ„**ï¼šå…ˆæ´¾ç”Ÿç±»è‡ªå·± â†’ å†æˆå‘˜ â†’ å†åŸºç±»ã€‚
-   è¿™å°±æ˜¯ C++ çš„å¯¹è±¡æ„é€ /ææ„æ¨¡å‹ï¼Œå’Œä½ ç†è§£çš„ä¸€æ ·ï¼Œåªæ˜¯è¿˜æœ‰â€œæˆå‘˜å˜é‡â€å’Œâ€œè™šåŸºç±»â€çš„é¡ºåºéœ€è¦æ³¨æ„ã€‚



### è”åˆä½“

è”åˆä½“çš„å†…å­˜å¯¹é½å’Œç»“æ„ä½“çš„å†…å­˜å¯¹é½



### å‹å…ƒå‡½æ•°



### `constexpr` å’Œ `const` å…³é”®å­—

ç”¨ `constexpr`ï¼š

*   éœ€è¦ç¼–è¯‘æœŸç¡®å®šçš„é‡ï¼ˆæ•°ç»„å¤§å°ã€æ¨¡æ¿å‚æ•°ç­‰ï¼‰
*   å¼ºåˆ¶å‡½æ•°/å¯¹è±¡åœ¨ç¼–è¯‘æœŸå¯è®¡ç®—
*   æ€§èƒ½æ•æ„Ÿçš„å¸¸é‡è®¡ç®—

ç”¨ `const`ï¼š

*   è¿è¡Œæ—¶å¸¸é‡
*   å‡½æ•°å‚æ•°/è¿”å›å€¼çš„åªè¯»çº¦æŸ
*   ç±»æˆå‘˜å¸¸é‡ï¼ˆéé™æ€æˆå‘˜ä¸èƒ½ç”¨ `constexpr`ï¼‰

**æœ€ä½³å®è·µ**ï¼šä¼˜å…ˆç”¨ `constexpr` è¡¨ç¤ºç¼–è¯‘æœŸå¸¸é‡ï¼Œç”¨ `const` è¡¨ç¤ºè¿è¡Œæ—¶å¸¸é‡æˆ–æ¥å£çº¦æŸã€‚C++17 èµ· `constexpr` å¯æ›¿ä»£å¤§éƒ¨åˆ† `const` çš„ç¼–è¯‘æœŸåœºæ™¯ã€‚



### `size_t`ã€`sizeof()`ã€`typedef`

å®é™…ä¸Šï¼Œ`size_t` æ˜¯ä¸ªæ— ç¬¦å·æ•´å‹ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå…¨æ–°çš„æ•°æ®ç±»å‹ï¼Œæ›´ä¸æ˜¯ä¸€ä¸ªå…³é”®å­—ã€‚`size_t` æ˜¯ç”± `typedef` å®šä¹‰è€Œæ¥çš„ï¼Œæˆ‘ä»¬åœ¨å¾ˆå¤šæ ‡å‡†åº“å¤´æ–‡ä»¶ä¸­éƒ½èƒ½å‘ç°ã€‚

C æ ‡å‡†å¤´æ–‡ä»¶`<stddef.h>`ä¸­å¯ä»¥æ‰¾åˆ°`size_t`çš„å®é™…å®šä¹‰ã€‚

é€šå¸¸ç”¨äºï¼š
(1) è¡¨ç¤ºå¯¹è±¡å¤§å°å’Œå†…å­˜åˆ†é…ï¼›
(2) è¡¨ç¤ºå®¹å™¨å¤§å°å’Œç´¢å¼•ï¼›
(3) å†…å­˜å’Œå­—ç¬¦ä¸²æ“ä½œï¼›

ä¸ºä»€ä¹ˆéœ€è¦ `size_t`ï¼š
(1) **å¹³å°æ— å…³æ€§**ï¼šè‡ªåŠ¨é€‚é…ä¸åŒæ¶æ„ï¼ˆ32ä½ç³»ç»Ÿé€šå¸¸ä¸º 4 å­—èŠ‚ï¼Œ64ä½ç³»ç»Ÿä¸º 8 å­—èŠ‚ï¼‰
(2) **è¶³å¤Ÿå¤§çš„è¡¨ç¤ºèŒƒå›´**ï¼šèƒ½è¡¨ç¤ºç³»ç»Ÿä¸­æœ€å¤§å¯èƒ½å¯¹è±¡çš„å¤§å°ï¼ˆåŒ…æ‹¬æ•´ä¸ªå†…å­˜ç©ºé—´ï¼‰
(3) **ç±»å‹å®‰å…¨**ï¼šåŒºåˆ†æ™®é€šæ•´æ•°å’Œå¤§å°/ç´¢å¼•å€¼
(4) **æ ‡å‡†åŒ–**ï¼šæ‰€æœ‰æ ‡å‡†åº“å®¹å™¨å’Œå†…å­˜ç›¸å…³å‡½æ•°ç»Ÿä¸€ä½¿ç”¨



### `struct` å’Œ `class` çš„åŒºåˆ«

åœ¨ C++ ä¸­ï¼Œ`struct` å’Œ `class` éƒ½ç”¨äºå®šä¹‰è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå®ƒä»¬çš„æ ¸å¿ƒåŠŸèƒ½å‡ ä¹ç›¸åŒï¼Œä¸»è¦åŒºåˆ«åœ¨äº**é»˜è®¤è®¿é—®æƒé™**å’Œ**é»˜è®¤ç»§æ‰¿æ–¹å¼**ã€‚

1.   é»˜è®¤è®¿é—®æƒé™ä¸åŒï¼š

     ```cpp
     // struct é»˜è®¤æ‰€æœ‰æˆå‘˜ä¸º public
     struct Point {
         int x;     // é»˜è®¤ä¸º public
         int y;     // é»˜è®¤ä¸º public
     };
     
     // class é»˜è®¤æ‰€æœ‰æˆå‘˜ä¸º private
     class Circle {
         double r;  // é»˜è®¤ä¸º private
     public:
         double area() { return 3.14 * r * r; }
     };
     ```

2.   é»˜è®¤ç»§æ‰¿æ–¹å¼ä¸åŒ

     ```cpp
     struct Base { int data; };
     
     // struct ç»§æ‰¿é»˜è®¤ä¸º public
     struct DerivedStruct : Base { 
         // å¯ç›´æ¥è®¿é—® Base::data (public)
     };
     
     class DerivedClass : Base { 
         // é»˜è®¤ä¸º private ç»§æ‰¿ï¼ŒBase::data ä¸å¯ç›´æ¥è®¿é—®
     };
     ```



### (`new`) V.S. (`::operator new` && `placement new`)

#### `new`

å½“ä½¿ç”¨æ™®é€šçš„ `new` çš„æ—¶å€™ï¼Œä¼šåšä¸¤ä»¶äº‹æƒ…ï¼š

1.   åˆ†é…å†…å­˜ï¼ˆè°ƒç”¨ `operator new`ï¼Œä»å †ä¸Šæ‹¿ç©ºé—´ï¼‰ï¼›
2.   è°ƒç”¨æ„é€ å‡½æ•°ï¼ˆç”¨ä¼ å…¥çš„å‚æ•°æ„é€ å¯¹è±¡ï¼‰ï¼›

å†…å­˜åˆ†é…å’Œå¯¹è±¡æ„é€ æ˜¯åœ¨ä¸€èµ·çš„ã€‚

ä½†æ˜¯æœ‰çš„æ—¶å€™æˆ‘ä»¬å¹¶ä¸å¸Œæœ›å†…å­˜åˆ†é…å’Œå¯¹è±¡æ„é€ åœ¨ä¸€èµ·æ‰§è¡Œï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ `std::vector` ä¸­ï¼Œæˆ‘ä»¬ä¼šç”³è¯· `capacity_ * sizeof(T)` çš„ç©ºé—´æ¥å­˜å‚¨ç±»å‹ T çš„å¯¹è±¡ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸å¸Œæœ›åœ¨ç”³è¯·ç©ºé—´çš„æ—¶å€™å°±åˆå§‹åŒ–è¿™äº›ç©ºé—´ï¼Œè€Œæ˜¯åœ¨è°ƒç”¨ `push_back()` æˆ–è€… `emplace_back()` æ‰å®é™…æ„é€ å…ƒç´ ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å†…å­˜åˆ†é…å’Œå¯¹è±¡æ„é€ åˆ†ç¦»ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨åˆ° `::operator new` å’Œ `placement new` äº†ã€‚

#### `::operator new` && `placement new`

ä½¿ç”¨ `::operator new` å’Œ `placement new` éœ€è¦å…ˆå¯¼å…¥å¤´æ–‡ä»¶ï¼š
```cpp
#include <new>
```

åœ¨[è‡ªå·±åŠ¨æ‰‹å®ç°vectorå®¹å™¨](../Projects/è‡ªå·±åŠ¨æ‰‹å®ç°vectorå®¹å™¨.md)ä¸­ï¼Œæˆ‘ä½¿ç”¨ `::operator new` æ¥è¿›è¡Œå†…å­˜åˆ†é…ï¼Œè¿”å›ç±»å‹æ˜¯ `void*`ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ `static_cast<T*>` è¿›è¡Œç±»å‹è½¬æ¢ï¼Œåˆ†é…çš„å†…å­˜å¤§å°ä¸º `capacity * sizeof(T)`ã€‚
```cpp
// ::operator new(å…ƒç´ æ•°é‡ * sizeof(å…ƒç´ ç±»å‹));
T* allocate(size_t capacity) {
    return static_cast<T*>(::operator new(capacity * sizeof(T)));
}
```

>   :warning: `::operator new(æ•°é‡ * sizeof(ç±»å‹))`  å¥½ `::operator new[](æ•°é‡ * sizeof(ç±»å‹))` çš„åŒºåˆ«ï¼Œæ›´æ¨èä½¿ç”¨ `::operator new(æ•°é‡ * sizeof(ç±»å‹))`ï¼Œé¿å…ä¸å¿…è¦çš„å¼€é”€ã€‚

ç„¶ååˆå®ç°äº† `emplace_back()` å‡½æ•°ç”¨äºåœ¨ç”¨æˆ·è°ƒç”¨ `push_back` æˆ–è€… `emplace_back()` çš„æ—¶å€™å®é™…æ„é€ å¯¹è±¡ï¼š

```cpp
// new (åœ°å€) T(arg1, arg2, ...);
new (data_ + size_) T(std::forward<Args>(args)...);
```

å¯¹åº”çš„ï¼Œåœ¨ä½¿ç”¨ `::operator new` å’Œ `placement new` ä¹‹åï¼Œåœ¨ææ„å¯¹è±¡å’Œé‡Šæ”¾å†…å­˜çš„æ—¶å€™ä¹Ÿéœ€è¦æ‰‹åŠ¨è°ƒç”¨ï¼š
```cpp
// æ¸…ç©º vectorï¼Œä½†ä¸é‡Šæ”¾å†…å­˜
void clear() {
    for (int i = 0; i < size_; ++ i) {
        // å¯¹åº”é POD ç±»å‹ï¼Œéœ€è¦æ˜¾å¼è°ƒç”¨æ¯ä¸ªå…ƒç´ çš„ææ„å‡½æ•°
        data_[i].~T();  // è°ƒç”¨å…ƒç´ çš„ææ„å‡½æ•°
    }
    size_ = 0;
}
```

```cpp
    // å†…å­˜é‡Šæ”¾
    void deallocate() {
        ::operator delete(data_);
        data_ = nullptr;
        capacity_ = 0;
    }
```



### å·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨

åœ¨ C++ ä¸­ï¼Œ**å·¦å€¼å¼•ç”¨ï¼ˆlvalue referenceï¼‰** å’Œ **å³å€¼å¼•ç”¨ï¼ˆrvalue referenceï¼‰** æ˜¯ä¸¤ç§ä¸åŒçš„å¼•ç”¨ç±»å‹ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äº **ç»‘å®šå¯¹è±¡çš„ç±»åˆ«ï¼ˆå·¦å€¼ or å³å€¼ï¼‰** å’Œ **ç”¨é€”ï¼ˆæ‹·è´ä¼˜åŒ– or èµ„æºè½¬ç§»ï¼‰**ã€‚

**å·¦å€¼**æ˜¯æŒ‡æ—¢èƒ½å‡ºç°åœ¨ç­‰å·å·¦è¾¹ä¹Ÿèƒ½å‡ºç°åœ¨ç­‰å·å³è¾¹çš„å˜é‡(æˆ–è¡¨è¾¾å¼)ï¼Œ**å³å€¼**åˆ™åªèƒ½å‡ºç°åœ¨ç­‰å·å³è¾¹ã€‚

*   **å·¦å€¼ï¼ˆlvalueï¼‰**ï¼šå¯ä»¥å–åœ°å€ã€æœ‰åå­—çš„æŒä¹…å¯¹è±¡ï¼ˆå¦‚å˜é‡ã€å‡½æ•°è¿”å›çš„å¼•ç”¨ç­‰ï¼‰ã€‚
    **ç»‘å®šåˆ°å·¦å€¼ï¼ˆlvalueï¼‰** çš„å¼•ç”¨ï¼Œç”¨ `&` è¡¨ç¤ºã€‚

    ```cpp
    int x = 10;  
    int& lref = x;  // âœ… å·¦å€¼å¼•ç”¨ç»‘å®šå·¦å€¼
    lref = 20;      // ä¿®æ”¹ x çš„å€¼
    
    int& bad = 42;  // âŒ é”™è¯¯ï¼šä¸èƒ½ç»‘å®šåˆ°å³å€¼ï¼ˆä¸´æ—¶å¯¹è±¡ï¼‰
    ```

*   **å³å€¼ï¼ˆrvalueï¼‰**ï¼šä¸´æ—¶å¯¹è±¡ã€å³å°†é”€æ¯çš„å¯¹è±¡ï¼ˆå¦‚å­—é¢é‡ã€`std::move` åçš„å¯¹è±¡ï¼‰ã€‚
    **ç»‘å®šåˆ°å³å€¼ï¼ˆrvalueï¼‰** çš„å¼•ç”¨ï¼Œç”¨ `&&` è¡¨ç¤ºã€‚

    ```cpp
    int&& rref = 42;          // âœ… å³å€¼å¼•ç”¨ç»‘å®šå³å€¼
    int x = 10;
    int&& rref2 = std::move(x);  // âœ… ä½¿ç”¨ std::move è½¬ä¸ºå³å€¼
    
    int&& bad = x;            // âŒ é”™è¯¯ï¼šä¸èƒ½ç›´æ¥ç»‘å®šå·¦å€¼
    ```



### ä¸‡èƒ½å¼•ç”¨



### `std::forward`



### å®Œç¾è½¬å‘ (Perfect Forwarding) 

å®Œç¾è½¬å‘æ˜¯ä¸€ç§åœ¨**æ¨¡æ¿å‡½æ•°**ä¸­ä¿æŒå‚æ•°çš„**å€¼ç±»åˆ«ï¼ˆå·¦å€¼æˆ–å³å€¼ï¼‰**çš„èƒ½åŠ›ã€‚å½“ä¸€ä¸ªå‡½æ•°æ¨¡æ¿æ¥æ”¶å‚æ•°å¹¶å°†å…¶è½¬å‘ç»™å¦ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åŸå§‹å‚æ•°çš„å·¦å€¼/å³å€¼å±æ€§èƒ½å¤Ÿå¾—åˆ°ä¿ç•™ã€‚

è¿™ä¸»è¦é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªç‰¹æ€§å®ç°ï¼š

-   **ä¸‡èƒ½å¼•ç”¨ (Universal References) / è½¬å‘å¼•ç”¨ (Forwarding References)**ï¼šå½“æ¨¡æ¿å‚æ•°å½¢å¦‚ `T&&`ï¼Œå¹¶ä¸” `T` æ˜¯ä¸€ä¸ªæ¨å¯¼çš„æ¨¡æ¿å‚æ•°æ—¶ï¼ˆä¾‹å¦‚ `template <typename T> void foo(T&& arg)`ï¼‰ï¼Œ`T&&` å°±ä¸å†ä»…ä»…æ˜¯å³å€¼å¼•ç”¨ï¼Œå®ƒä¼šæ ¹æ®ä¼ å…¥å‚æ•°çš„ç±»å‹è¡¨ç°å‡ºä¸¤ç§è¡Œä¸ºï¼š
    -   å¦‚æœä¼ å…¥çš„æ˜¯**å·¦å€¼**ï¼Œ`T` ä¼šè¢«æ¨å¯¼ä¸º `Type&` (ä¸€ä¸ªå·¦å€¼å¼•ç”¨ç±»å‹)ï¼Œé‚£ä¹ˆ `Type& &&` ç»è¿‡å¼•ç”¨æŠ˜å åå˜ä¸º `Type&` (å·¦å€¼å¼•ç”¨)ã€‚
    -   å¦‚æœä¼ å…¥çš„æ˜¯**å³å€¼**ï¼Œ`T` ä¼šè¢«æ¨å¯¼ä¸º `Type` (ä¸€ä¸ªéå¼•ç”¨ç±»å‹)ï¼Œé‚£ä¹ˆ `Type&&` ä¿æŒä¸º `Type&&` (å³å€¼å¼•ç”¨)ã€‚ å› æ­¤ï¼Œ`T&&` èƒ½å¤Ÿâ€œä¸‡èƒ½åœ°â€æ¥æ”¶å·¦å€¼å’Œå³å€¼ã€‚
-   **`std::forward<T>(arg)`**ï¼šè¿™æ˜¯å®Œç¾è½¬å‘çš„æ ¸å¿ƒå·¥å…·ã€‚å®ƒæ˜¯ä¸€ä¸ªæ¡ä»¶æ€§è½¬æ¢ï¼š
    -   å¦‚æœ `arg` æœ€åˆæ˜¯**å·¦å€¼**ï¼Œ`std::forward` ä¼šå°†å…¶è½¬æ¢å›**å·¦å€¼å¼•ç”¨**ï¼ˆ`Type& &&` æŠ˜å ä¸º `Type&`ï¼‰ã€‚
    -   å¦‚æœ `arg` æœ€åˆæ˜¯**å³å€¼**ï¼Œ`std::forward` ä¼šå°†å…¶è½¬æ¢ä¸º**å³å€¼å¼•ç”¨**ï¼ˆ`Type&&` ä¿æŒä¸º `Type&&`ï¼‰ã€‚

è¿™æ ·ï¼Œ`std::forward` ç¡®ä¿äº†å‚æ•°åœ¨è½¬å‘è¿‡ç¨‹ä¸­ä¿æŒå…¶åŸå§‹çš„å€¼ç±»åˆ«ã€‚

**ä»£ç ç¤ºä¾‹**

```cpp
#include <iostream>
#include <string>
#include <utility>

void real_func(const std::string& s) {
    std::cout << "å·¦å€¼ç‰ˆæœ¬: " << s << "\n";
}

void real_func(std::string&& s) {
    std::cout << "å³å€¼ç‰ˆæœ¬: " << s << "\n";
}

template <typename T>
void wrapper(T&& arg) { // ä¸‡èƒ½å¼•ç”¨
    // å®Œç¾è½¬å‘
    real_func(std::forward<T>(arg));
}

int main() {
    std::string s = "hello";
    wrapper(s);  // å·¦å€¼è°ƒç”¨
    wrapper(std::string("world"));  // å³å€¼è°ƒç”¨
}
```

**å¸¸è§åº”ç”¨åœºæ™¯**

1.  **å®¹å™¨çš„ `emplace` ç³»åˆ—**
     `std::vector::emplace_back` ç”¨å®Œç¾è½¬å‘æŠŠå‚æ•°ç›´æ¥ä¼ ç»™å…ƒç´ æ„é€ å‡½æ•°ï¼Œé¿å…ä¸´æ—¶å¯¹è±¡ã€‚

2.  **å·¥å‚å‡½æ•°**

    ```
    template <typename T, typename... Args>
    std::unique_ptr<T> make_smart(Args&&... args) {
        return std::unique_ptr<T>(new T(std::forward<Args>(args)...));
    }
    ```

3.  **é€šç”¨å°è£… / è£…é¥°å™¨æ¨¡å¼**

    -   ä¾‹å¦‚åŒ…è£…ä¸€ä¸ªæ—¥å¿—å‡½æ•°ï¼Œç„¶åæŠŠå‚æ•°â€œå®Œç¾è½¬å‘â€åˆ°çœŸå®é€»è¾‘å‡½æ•°ã€‚



### å¯å˜å‚æ•°æ¨¡æ¿ï¼ˆvariadic templatesï¼‰

```cpp
// å®Œç¾è½¬å‘
template <typename... Args>
T& emplace_back(Args&&... args) {
    if (size_ == capacity_) {
        reallocate(capacity_ == 0 ? 1 : capacity_ * 2);
    }

    new (data_ + size_) T(std::forward<Args>(args)...);  // å®Œç¾è½¬å‘
    return data_[size_ ++];
}
```

åœ¨å¦‚ä¸Šå®Œç¾è½¬å‘çš„ä»£ç ä¸­ï¼Œä½¿ç”¨åˆ°äº† å¯å˜å‚æ•°æ¨¡æ¿ï¼ˆvariadic templatesï¼‰ å’Œ å‚æ•°åŒ…å±•å¼€ï¼ˆparameter pack expansionï¼‰ã€‚

å…·ä½“æ¥è¯´ï¼š

#### 1. `template <typename... Args>` â€” å®šä¹‰å‚æ•°åŒ…

-   `...` åœ¨ç±»å‹ååé¢ï¼ˆ`typename... Args`ï¼‰è¡¨ç¤º **Args æ˜¯ä¸€ä¸ªç±»å‹å‚æ•°åŒ…**ï¼Œå¯ä»¥ä»£è¡¨ä»»æ„å¤šä¸ªç±»å‹ï¼š

    ```cpp
    Args = {int, double, std::string} // å¯èƒ½çš„æƒ…å†µ
    Args = {std::string}              // ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª
    Args = {}                         // ç”šè‡³å¯ä»¥æ˜¯ç©º
    ```

-   å°±å¥½åƒ `Args` æ˜¯ä¸€ä¸ª**ç±»å‹åˆ—è¡¨**ã€‚

#### 2. `Args&&... args` â€” ä¸‡èƒ½å¼•ç”¨çš„å‚æ•°åŒ…

-   `args` æ˜¯ä¸€ä¸ª**å‚æ•°åŒ…å˜é‡**ï¼Œé‡Œé¢æœ‰å¤šä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ç±»å‹å¯¹åº” `Args` é‡Œçš„ä¸€ä¸ªç±»å‹ã€‚
-   å› ä¸ºæ˜¯ `Args&&` å¹¶ä¸” `Args` æ˜¯æ¨¡æ¿å‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ **ä¸‡èƒ½å¼•ç”¨å‚æ•°åŒ…**ï¼Œå¯ä»¥åŒæ—¶æ¥æ”¶ï¼š
    -   ä»»æ„æ•°é‡çš„å·¦å€¼
    -   ä»»æ„æ•°é‡çš„å³å€¼
    -   ä»»æ„æ··åˆçš„å·¦å€¼å’Œå³å€¼

#### 3. `std::forward<Args>(args)...` â€” å‚æ•°åŒ…å±•å¼€

-   æœ€åçš„ `...` æ˜¯ **å±•å¼€æ“ä½œ**ï¼ˆpack expansionï¼‰ã€‚
-   ä½œç”¨ï¼šæŠŠ `args` é‡Œçš„å¤šä¸ªå‚æ•°ï¼Œä¾æ¬¡ç”¨ `std::forward` è½¬å‘ï¼Œç„¶åæŒ‰é¡ºåºå±•å¼€æˆå®å‚åˆ—è¡¨ã€‚
-   å¦‚æœä½ å»æ‰ `...`ï¼Œç¼–è¯‘å™¨ä¼šè¯´å®ƒä¸çŸ¥é“æ€ä¹ˆæŠŠä¸€æ•´ä¸ªåŒ…ä¼ ç»™æ„é€ å‡½æ•°ï¼Œå› ä¸ºæ„é€ å‡½æ•°æ˜¯æœŸæœ›**å¤šä¸ªå‚æ•°**ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªâ€œåŒ…å¯¹è±¡â€ã€‚

ä¾‹å­ï¼š

```cpp
emplace_back(42, 3.14, "hello");

// å±•å¼€è¿‡ç¨‹ï¼š
std::forward<Args>(args)...   // å±•å¼€æˆï¼š
std::forward<int>(42), std::forward<double>(3.14), std::forward<const char*>("hello")
```

#### 4. ä¸ºä»€ä¹ˆå¿…é¡»å±•å¼€ï¼Ÿ

å› ä¸º C++ é‡Œæ„é€ å‡½æ•°ï¼ˆ`T(...)`ï¼‰çš„å‚æ•°æ˜¯ä¸€ä¸ªä¸€ä¸ªåŒ¹é…çš„ï¼Œè€Œå‚æ•°åŒ…æ˜¯ä¸€ä¸ªâ€œé›†åˆâ€ï¼Œè¦è®©ç¼–è¯‘å™¨è‡ªåŠ¨æŠŠå®ƒæ‹†æˆå•ä¸ªå‚æ•°ä¼ è¿‡å»ï¼Œå°±éœ€è¦ `...` æ¥å±•å¼€ã€‚

`...` å‡ºç°åœ¨ä¸åŒä½ç½®çš„æ„ä¹‰ï¼š

-   å®šä¹‰ç±»å‹åŒ…ï¼š`typename... Args`
-   å®šä¹‰å˜é‡åŒ…ï¼š`Args&&... args`
-   å±•å¼€ï¼š`std::forward<Args>(args)...`

#### 5. ç»“åˆä½ çš„ `emplace_back`

```cpp
new (data_ + size_) T(std::forward<Args>(args)...);
```

å®ƒçš„æ„æ€æ˜¯ï¼š

-   å– `args` é‡Œçš„æ¯ä¸ªå‚æ•°ï¼Œ
-   æ ¹æ® `Args` çš„æ¨å¯¼ç»“æœå†³å®šå®ƒæ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œ
-   ä¿ç•™åŸæœ¬çš„å€¼ç±»åˆ«ï¼ˆå®Œç¾è½¬å‘ï¼‰ï¼Œ
-   æŒ‰é¡ºåºä¸€ä¸ªä¸ªä¼ ç»™ `T` çš„æ„é€ å‡½æ•°ã€‚



### `std::map`

è¯»å–å…ƒç´ æ—¶ï¼Œç»Ÿä¸€ç”¨ `at()`

å†™å…¥å…ƒç´ æ—¶ï¼Œç»Ÿä¸€ç”¨ `[]`

```cpp
std::map<std::string, int> m;
auto val = m.at("key1");  // è¯»
m["key2"] = val;  // å†™
```



### æµ…æ‹·è´ä¸æ·±æ‹·è´

**æµ…æ‹·è´(Shallow Copy)**å’Œ**æ·±æ‹·è´(Deep Copy)**



### `std::pair` çš„ç”¨æ³•å’Œä¼˜åŠ¿

`std::pair` æ˜¯ä¸€ä¸ªç®€å•ä½†æå…¶æœ‰ç”¨çš„å·¥å…·ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š

1. **è½»é‡é«˜æ•ˆ**ï¼šé›¶å¼€é”€æŠ½è±¡
2. **é€šç”¨æ€§å¼º**ï¼šé€‚ç”¨äºå„ç§åœºæ™¯
3. **ä¸ STL æ·±åº¦é›†æˆ**ï¼šå®¹å™¨å’Œç®—æ³•çš„å…³é”®ç»„æˆéƒ¨åˆ†
4. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
5. **ç°ä»£ç‰¹æ€§æ”¯æŒ**ï¼šç»“æ„åŒ–ç»‘å®šã€ç§»åŠ¨è¯­ä¹‰ç­‰

ä½¿ç”¨åœºæ™¯å»ºè®®ï¼š

- éœ€è¦è¿”å›ä¸¤ä¸ªå€¼æ—¶â€‹ â” æ›¿ä»£è¾“å‡ºå‚æ•°
- åˆ›å»ºç®€å•é”®å€¼å¯¹ â” æ›¿ä»£ç®€å•ç»“æ„ä½“
- éœ€è¦ä¸´æ—¶ç»„åˆæ•°æ® â” é¿å…å®šä¹‰ä¸´æ—¶ç»“æ„
- ä¸ STL ç®—æ³•é…åˆ â” åˆ©ç”¨å†…ç½®æ¯”è¾ƒæ“ä½œ

å½“éœ€è¦ç»„åˆè¶…è¿‡ä¸¤ä¸ªå€¼æ—¶ï¼Œå¯å‡çº§åˆ° `std::tuple`ï¼Œä½† `std::pair` åœ¨äºŒå…ƒæ•°æ®ç»„åˆåœºæ™¯ä¸­ä»æ˜¯æœ€ç®€æ´é«˜æ•ˆçš„é€‰æ‹©ã€‚



### `std::tuple`

tuple ç”¨äºå‡½æ•°å¤šä¸ªè¿”å›å€¼

```cpp
#include <iostream>
#include <tuple>
#include <cmath>

std::tuple<bool, float> mysqrt(float x) {
    if (x >= 0.f) {
        return {true, std::sqrt(x)};
    } else {
        return {false, 0.0f};
    }
}

int main() {
    auto [success, value] = mysqrt(4.f);
    if (success) {
        printf("Succeed!, the result is %.2f\n", value);
    } else {
        printf("Failed, the input is lower than 0\n");
    }
    return 0;
}
```



### æ™ºèƒ½æŒ‡é’ˆ

#### `std::unique_ptr`



#### `std::shared_ptr`

```cpp
mysql_connection *conn = mysql_connect("127.0.0.1");
mysql_execute(conn, "drop database paolu");
mysql_close(conn); // ç”¨æˆ·å¯èƒ½å¿˜è®°å…³é—­è¿æ¥ï¼ç ´ååº“è®¾è®¡è€…æƒ³è¦çš„ç”¨æ³•
```

`std::shared_ptr` å°å¦™æ‹›ï¼šæ„é€ å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æŒ‡å®šé‡Šæ”¾å‡½æ•°ï¼Œä»£æ›¿é»˜è®¤çš„ delete

```cpp
auto conn = std::shared_ptr<mysql_connection>(mysql_connect("127.0.0.1"), mysql_close);
mysql_execute(conn.get(), "drop database paolu");
// conn ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ mysql_closeï¼Œæœç»äº†ä¸€ä¸ªå‡ºé”™çš„å¯èƒ½
```



### å¸¸é‡æˆå‘˜å‡½æ•°



```cpp
class MyClass {
    int value = 0;
public:
    void fun(const int& a) const {
        value = a; // é”™è¯¯ï¼ä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡
    }
};
```





## å‚è€ƒèµ„æ–™

[1] [å¿«é€Ÿå­¦ä¹ Cå’ŒC++ï¼ŒåŸºç¡€è¯­æ³•å’Œä¼˜åŒ–ç­–ç•¥ï¼Œå­¦äº†ä¸å†æ€•æŒ‡é’ˆ(å—ç§‘å¤§è®¡ç®—æœºç³»åŸç‰ˆ)](https://www.bilibili.com/video/BV1Vf4y1P7pq), [GitHub](https://github.com/ShiqiYu/CPP)

[2] [åˆé›†Â·é«˜æ€§èƒ½å¹¶è¡Œç¼–ç¨‹ä¸ä¼˜åŒ– - å½•æ’­](https://space.bilibili.com/263032155/channel/collectiondetail?sid=53025)

[3] [åˆé›†Â·ç°ä»£C++é¡¹ç›®å®æˆ˜](https://space.bilibili.com/263032155/channel/collectiondetail?sid=599074)

[4] [hacking C++](https://hackingcpp.com/)

[5] [å­¦ä¹ è·¯çº¿](https://www.zhihu.com/collection/978731703)

[6] 



